#!/bin/bash
#; bashrc
#; Generic user environment and startup programs
#; This script will also source local setup files:
#; aliases: setup generic aliases
#; local/bashrc: extra localised environment
#; local/local_aliases: extra localised aliases
SHELL=bash
export SHELL

echo in bashrc
pwd
echo ok

# make cygwin case insensitive
#shopt -s nocaseglob

# are we running under cygwin
type cygpath > /dev/null 2>&1
cygwin="$?"

if [ $cygwin = 0 ]; then
    # convert the initial windows path (replacing space-filled names e.g. Program Files as necessary)
    export PATHWIN=$PATH
    PATH=`cygpath --mixed --path --short-name "$PATH" | xargs cygpath --unix --path`
    export PATHORIG=$PATH
    #; Start with a basic PATH - then addon/override in aliases
    PATH="$PATH:/usr/sbin:/bin:/sbin"
#else just take the path as configured
fi

# unset mail checking
unset MAILCHECK

#; set NODENAME for later use
NODENAME="`uname -n`"
export NODENAME

#; Localised configuration
if [ -f ${HOME}/shell/.shell/local_$NODENAME/bashrc ]; then
      . ${HOME}/shell/.shell/local_$NODENAME/bashrc
fi

export PATH

#; Add in local directories, just for fun and convenience
PATH="/usr/local/bin:/usr/local/sbin:${PATH}"
export PATH

#; Setup a safe $TMP dir
if [ -d "${HOME}/tmp" ]; then
 TMP="${HOME}/tmp"
 TMPDIR="${HOME}/tmp"
 export TMP TMPDIR
else
 mkdir ${HOME}/tmp
 chmod 700 ${HOME}/tmp
 TMP="${HOME}/tmp"
 TMPDIR="${HOME}/tmp"
 export TMP TMPDIR
 echo " ! $TMP was created."
fi

#; Configure the editor.
if (type emacs &>/dev/null); then
 EDITOR="emacs"
 VISUAL="${EDITOR}"
 export EDITOR VISUAL
elif (type vim &>/dev/null); then
 EDITOR="vim"
 VISUAL="${EDITOR}"
 export EDITOR VISUAL
 alias vi="vim"
else
 EDITOR="vi"
 VISUAL="${EDITOR}"
 export EDITOR VISUAL
 alias vim="vi"
fi

#; Setup shell environment depending on the shell.
case "$0" in
 /usr/bin/bash)
#  BASH_ENV="${HOME}/shell/.shell/bashrc"
  BASH_ENV="${HOME}/shell/.shell/minimalshell"
  HISTFILE="${HOME}/tmp/history"
  HISTSIZE="2048"
  export BASH_ENV HISTFILE HISTSIZE PROMPT_COMMAND
  ignoreeof=36
 ;;

 bash | -*bash | -*bash2 )
#  BASH_ENV="${HOME}/shell/.shell/bashrc"
  BASH_ENV="${HOME}/shell/.shell/minimalshell"
  HISTFILE="${HOME}/tmp/history"
  HISTSIZE="2048"
  export BASH_ENV HISTFILE HISTSIZE PROMPT_COMMAND
  ignoreeof=36
 ;;

 sh | ksh )
  PS1="${NODENAME}% "
  PS2="> "
  PS3="{${NODENAME}}% "
  PS4=">> "
  HISTSIZE="2048"
  export PS1 PS2 PS3 PS4
  export HISTSIZE
 ;;
esac

# Some bash settings.
rm -f ~/.bash_history 2> /dev/null
HISTFILE=~/.history		# History goes into ~/.history.
FIGNORE='.o:.lo:.class:~'	# Ignore some files in file name completion.

export LOGNAME=gary_mcwilliams

#; CVS variables.
CVS_RSH="ssh"
CVSDEFAULTWORKDIR="/d/projects/cvsroot"
CVSWORKDIR="cd ${CVSDEFAULTWORKDIR}"

#; SVN variables
SVN_SSH='ssh -l gary'
export SVN_SSH

if [ -d ~/shell/tools ]; then
  PATH="~/shell/tools:$PATH"
  if [ -e ~/shell/tools/envmsvc ]; then
      . ~/shell/tools/envmsvc
  fi
fi

sshcfg()
{
	eval `ssh-agent`
	ssh-add
}

#; $Id: bashrc,v 1.13 2004/11/30 11:13:34 gary Exp $